<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <title>Admin Inventory â€“ Supermarket App</title>

  <style>
      body {
          background: linear-gradient(to bottom right, #f4f7fb, #eef2f7);
      }

      .sidebar-box {
          background: white;
          padding: 20px;
          border-radius: 15px;
          box-shadow: 0 4px 12px rgba(0,0,0,0.1);
          position: sticky;
          top: 20px;
      }

      .product-card {
          width: 300px;
          border-radius: 18px;
          overflow: hidden;
          background: #ffffff;
          border: none;
          transition: transform 0.25s ease, box-shadow 0.25s ease;
      }

      .product-card:hover {
          transform: translateY(-6px);
          box-shadow: 0 12px 30px rgba(0,0,0,0.15);
      }

      .product-img-container {
          background: #f7f9fc;
          padding: 25px;
          height: 200px;
          display: flex;
          align-items: center;
          justify-content: center;
      }

      .product-img {
          max-height: 150px;
          object-fit: contain;
      }

      .admin-btn {
          width: 48%;
      }

      .low-stock {
          color: red;
          font-weight: bold;
      }
  </style>
</head>

<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-sm bg-dark navbar-dark shadow-sm">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">Supermarket App</a>

    <div class="collapse navbar-collapse">
      <ul class="navbar-nav ms-auto">

        <!-- â­ Dashboard -->
        <li class="nav-item">
          <a class="nav-link" href="/admin/dashboard">Dashboard</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/addProduct">Add Product</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/admin/users">User List</a>
        </li>

        <li class="nav-item">
          <a class="nav-link" href="/logout">Logout</a>
        </li>

      </ul>
    </div>
  </div>
</nav>

<div class="container mt-4">
  
  <h2 class="text-center fw-bold mb-4">Admin Inventory</h2>
  <p class="text-center">Welcome, <%= user.username %> (admin)</p>

  <div class="row mt-4">

    <!-- ========== SIDEBAR ========== -->
    <div class="col-md-3 mb-4">
      <div class="sidebar-box">

        <h5 class="fw-bold mb-3">Inventory Overview</h5>

        <p><strong>Total Listed Products:</strong> <%= products.length %></p>

        <p class="fw-bold mt-3"> Low Stock Items:</p>
        <ul>
          <% products.forEach(p => { %>
            <% if (p.quantity < 10) { %>
              <li class="low-stock"><%= p.productName %> (Stock: <%= p.quantity %>)</li>
            <% } %>
          <% }) %>
        </ul>

        <hr>

        <h6 class="fw-bold">Quick Actions</h6>
        <a href="/addProduct" class="btn btn-primary w-100 mb-2">âž• Add Product</a>
        <a href="/admin/dashboard" class="btn btn-secondary w-100 mb-2">ðŸ“ˆ View Dashboard</a>
        <a href="/admin/users" class="btn btn-dark w-100">ðŸ‘¤ Manage Users</a>

      </div>
    </div>

    <!-- ========== PRODUCT CARDS ========== -->
    <div class="col-md-9">
      <div class="d-flex flex-wrap justify-content-center gap-4">

        <% products.forEach(p => { %>

          <div class="card product-card shadow-sm">

            <div class="product-img-container">
              <img src="/images/<%= p.image %>" class="product-img">
            </div>

            <div class="card-body text-center">

              <h5 class="fw-bold">
                <a href="/product/<%= p.id %>" class="text-decoration-none">
                  <%= p.productName %>
                </a>
              </h5>

              <p class="text-muted mb-1">Stock: 
                <% if (p.quantity < 10) { %>
                    <span class="low-stock"><%= p.quantity %></span>
                <% } else { %>
                    <%= p.quantity %>
                <% } %>
              </p>

              <p class="fw-bold">$<%= p.price.toFixed(2) %></p>

              <!-- ADMIN ACTION BUTTONS -->
              <div class="d-flex justify-content-between mt-3">
                <a href="/updateProduct/<%= p.id %>" class="btn btn-warning admin-btn">Edit</a>

                <a 
                  href="/deleteProduct/<%= p.id %>" 
                  class="btn btn-danger admin-btn"
                  onclick="return confirm('Are you sure you want to delete this product?');">
                  Delete
                </a>
              </div>
            </div>
          </div>

        <% }) %>

      </div>
    </div>

  </div>

</div>

</body>
</html>
